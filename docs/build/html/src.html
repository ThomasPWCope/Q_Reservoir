<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src package &mdash; QuantumReservoirComputing  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="https://assets.readthedocs.org/static/css/badge_only.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script async="async" src="https://assets.readthedocs.org/static/javascript/readthedocs-doc-embed.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="src" href="modules.html" /> 

<!-- RTD Extra Head -->

<link rel="stylesheet" href="https://assets.readthedocs.org/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": "", "api_host": "", "builder": "sphinx", "canonical_url": "", "docroot": "", "features": {"docsearch_disabled": false}, "global_analytics_code": null, "language": "", "page": "src", "programming_language": "", "project": "", "source_suffix": ".rst", "subprojects": {}, "theme": "", "user_analytics_code": null, "version": ""}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>

<script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-analytics.js" async="async"></script>

<!-- end RTD <extrahead> -->
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            QuantumReservoirComputing
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">src</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">src package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.basemodel">src.basemodel module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.circuits">src.circuits module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.continuous">src.continuous module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.data">src.data module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.feedforward">src.feedforward module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.helpers">src.helpers module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.noisemodel">src.noisemodel module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.rewinding">src.rewinding module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">QuantumReservoirComputing</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">src</a></li>
      <li class="breadcrumb-item active">src package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/src.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="src-package">
<h1>src package<a class="headerlink" href="#src-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-src.basemodel">
<span id="src-basemodel-module"></span><h2>src.basemodel module<a class="headerlink" href="#module-src.basemodel" title="Permalink to this heading"></a></h2>
<p>Parent classes for the quantum reservoir computing models.</p>
<p>None of the classes here work on their own.</p>
<dl class="py class">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.basemodel.</span></span><span class="sig-name descname"><span class="pre">PredictionModelBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">washout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_x_as_feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nyfuture</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_future_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_l1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_degree</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Parent class.
Does not work on its own.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log</strong> (<em>bool</em>) – Whether to log results and model parameters in <cite>results/model.parquet</cite>.</p></li>
<li><p><strong>rseed</strong> (<em>int</em>) – Random seed for reproducibility.</p></li>
<li><p><strong>washout</strong> (<em>int</em>) – Number of timesteps to discard at the beginning of the dataset.</p></li>
<li><p><strong>add_x_as_feature</strong> (<em>bool</em>) – Whether to add the raw input x(t) as a feature to the fitter.</p></li>
<li><p><strong>regression_model</strong> (<em>str</em>) – Which regression model to use. Options: ‘ridge’, ‘lasso’, ‘elasticnet’, ‘linear’.</p></li>
<li><p><strong>regression_alpha</strong> (<em>float</em>) – Regularization parameter for ridge, lasso, elasticnet.</p></li>
<li><p><strong>regression_l1</strong> (<em>float</em>) – L1 ratio for elasticnet.</p></li>
<li><p><strong>fitter</strong> (<em>str</em>) – Which fitter to use. Options: ‘sklearn’, ‘sklearn_poly’.</p></li>
<li><p><strong>poly_degree</strong> (<em>int</em>) – Degree of polynomial features to add to the fitter (only for fitter=’sklearn_poly’).</p></li>
<li><p><strong>nyfuture</strong> (<em>int</em>) – <div class="line-block">
<div class="line">How many future steps to predict.</div>
<div class="line">Only the next predicted step is used, but it can make predictions better.</div>
<div class="line">During training the fitter uses all next step predictions, but the reported loss (e.g. self.mse_train) is only with respect to the next step.</div>
<div class="line">E.g. 2 means predicting {y(t), y(t+1)} at each step t.</div>
</div>
</p></li>
<li><p><strong>delete_future_y</strong> (<em>bool</em>) – Only has an impact if nyfuture &gt; 1.
Only affects the fitting during the training phase. Predictions are unaffected.
At the last few timesteps we will predict future steps beyond the dataset.
Solution 1 (True): delete the last few timeseps, at the cost of having a few less training samples. Works better in practice.
Solution 2 (False): make up the values beyond the dataset, e.g. by assuming the dataset stays constant.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase._fit">
<span class="sig-name descname"><span class="pre">_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ys</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#src.basemodel.PredictionModelBase._fit" title="Permalink to this definition"></a></dt>
<dd><p>Fit features to desired output using Ordinary least squares (OLS).</p>
<p>OLS is linear regression with a quadratic loss (mean squared error),
and can be optimized in a single step by solving a linear system of equations.</p>
<p>Problem is convex -&gt; the optimum lies at gradient zero.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Linear_least_squares">https://en.wikipedia.org/wiki/Linear_least_squares</a></p>
<div class="math notranslate nohighlight">
\[s^{pred} = f  w\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}L_{MSE} &amp;= \vert s^{pred} - s^{true} \vert^2 \\
&amp;= \left( f  w - s^{true} \right)^T \left( f  w - s^{true} \right) \\
&amp;= (s^{true})^T s^{true} - (s^{true})^T f w - w^T f^T s^{true} + w^T f^T f w\\\end{split}\]</div>
<p>Minimizing the loss function with respect to the weights:</p>
<div class="math notranslate nohighlight">
\[dL_{MSE}/dw = 2 (-f^T s^{true} + f^T f w)\]</div>
<p>Optimal weights:</p>
<div class="math notranslate nohighlight">
\[w_{opt} = (f^T f)^{-1} f^T s^{true}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> – list of reservoir outputs for each episode. (episode, steps, dimf)</p></li>
<li><p><strong>ys</strong> – list of true values trying to fit to for each episode. (episode, steps, dim_y)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase._init_logging">
<span class="sig-name descname"><span class="pre">_init_logging</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase._init_logging" title="Permalink to this definition"></a></dt>
<dd><p>Set filename and check if we can write to it.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase._judge_train">
<span class="sig-name descname"><span class="pre">_judge_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred_nonorm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytrue_nonorm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase._judge_train" title="Permalink to this definition"></a></dt>
<dd><p>Calculate error metrics between prediction and true.
Write results to self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ytrue</strong> (<em>np.ndarray</em>) – Prediction and true values.</p></li>
<li><p><strong>ypred</strong> (<em>np.ndarray</em>) – Prediction and true values.</p></li>
<li><p><strong>ytrue_nonorm</strong> (<em>np.ndarray</em>) – Prediction and true values, unnormalized.</p></li>
<li><p><strong>ypred_nonorm</strong> (<em>np.ndarray</em>) – Prediction and true values, unnormalized.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase._judge_val">
<span class="sig-name descname"><span class="pre">_judge_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred_nonorm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytrue_nonorm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase._judge_val" title="Permalink to this definition"></a></dt>
<dd><p>Calculate error metrics between prediction and true.
Write results to self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ytrue</strong> (<em>np.ndarray</em>) – Prediction and true values.</p></li>
<li><p><strong>ypred</strong> (<em>np.ndarray</em>) – Prediction and true values.</p></li>
<li><p><strong>ytrue_nonorm</strong> (<em>np.ndarray</em>) – Prediction and true values, unnormalized.</p></li>
<li><p><strong>ypred_nonorm</strong> (<em>np.ndarray</em>) – Prediction and true values, unnormalized.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase._log_results">
<span class="sig-name descname"><span class="pre">_log_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase._log_results" title="Permalink to this definition"></a></dt>
<dd><p>Write results, model settings, and data settings to file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase._plot_features">
<span class="sig-name descname"><span class="pre">_plot_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nepisodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase._plot_features" title="Permalink to this definition"></a></dt>
<dd><p>Plot features and input data for a handful of episodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> – list[np.array]: (episode, steps, dim)</p></li>
<li><p><strong>x</strong> – list[np.array]: (episode, steps, dim)</p></li>
<li><p><strong>nepisodes</strong> (<em>int</em>) – maximum number of episodes to be plotted</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase._plot_prediction">
<span class="sig-name descname"><span class="pre">_plot_prediction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nepisodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase._plot_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Plot predictions and true values for a handful of episodes.
:param ypred: list[np.array]: (episode, steps, dimy)
:param ytrue: list[np.array]: (episode, steps, dimy)
:param x: list[np.array]: (episode, steps, dimy)
:param nepisodes: maximum number of episodes to be plotted
:type nepisodes: int</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase._policy">
<span class="sig-name descname"><span class="pre">_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase._policy" title="Permalink to this definition"></a></dt>
<dd><p>A placeholder policy which returns the action x(t) given the observation y(t-1).</p>
<p>Actions are taken from the training or testing data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>np.ndarray</em>) – Observation y(t-1). Not used, since we are using data.</p></li>
<li><p><strong>e</strong> (<em>int</em>) – Episode number. Used to pull data from self.data.</p></li>
<li><p><strong>step</strong> (<em>int</em>) – Step number. Used to pull data from self.data.</p></li>
<li><p><strong>offset</strong> (<em>int</em>) – xyoffset. If offset=1, dont do the last prediction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Action x(t).
Or False if step is out of bounds.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase._predict">
<span class="sig-name descname"><span class="pre">_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase._predict" title="Permalink to this definition"></a></dt>
<dd><p>Predicts y from features (one episode).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase._set_data_dims">
<span class="sig-name descname"><span class="pre">_set_data_dims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase._set_data_dims" title="Permalink to this definition"></a></dt>
<dd><p>Deduce dimensions of x and y data from Data object.
:param data_obj: Instance of DataSource class.
:type data_obj: DataSource</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase._set_fitter">
<span class="sig-name descname"><span class="pre">_set_fitter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase._set_fitter" title="Permalink to this definition"></a></dt>
<dd><p>Set regression model and polynomial features.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase._set_unitary_and_meas">
<span class="sig-name descname"><span class="pre">_set_unitary_and_meas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase._set_unitary_and_meas" title="Permalink to this definition"></a></dt>
<dd><p>Define quantum circuit at every timestep.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>unitary at every timestep.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>self.unistep (qiskit.QuantumCircuit)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase.get_hyperparameters">
<span class="sig-name descname"><span class="pre">get_hyperparameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase.get_hyperparameters" title="Permalink to this definition"></a></dt>
<dd><p>Return a dictionary of passable parameters and their current values.
Use to recreate instance:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_hyperparameters</span><span class="p">()</span>
<span class="n">model_copy</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase.get_results">
<span class="sig-name descname"><span class="pre">get_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase.get_results" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary of evaluation metrics of fit and prediction.</p>
<p>Includes Squared Pearson correlation coefficient, Mean Squared Error,
Mean Absolute Percentage Error, Normalized Root Mean Squared Error.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase.get_results_and_parameters">
<span class="sig-name descname"><span class="pre">get_results_and_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase.get_results_and_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Return a dictionary of results and parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase.model_name">
<span class="sig-name descname"><span class="pre">model_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'prediction_model_base'</span></em><a class="headerlink" href="#src.basemodel.PredictionModelBase.model_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase.plot_best_val_episodes">
<span class="sig-name descname"><span class="pre">plot_best_val_episodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nepisodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_normed_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase.plot_best_val_episodes" title="Permalink to this definition"></a></dt>
<dd><p>Calls <code class="xref py py-func docutils literal notranslate"><span class="pre">_plot_prediction()</span></code> with the episodes in the validation data that have the smallest MSE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<em>str</em>) – title of plot. If None, use ‘Validation’.</p></li>
<li><p><strong>nepisodes</strong> (<em>int</em>) – number of episodes to be plotted.</p></li>
<li><p><strong>px</strong> – bool: if to plot x (input)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase.plot_train">
<span class="sig-name descname"><span class="pre">plot_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nepisodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_normed_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase.plot_train" title="Permalink to this definition"></a></dt>
<dd><p>Calls <code class="xref py py-func docutils literal notranslate"><span class="pre">_plot_prediction()</span></code> with training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<em>str</em>) – title of plot. If None, use ‘Train’.</p></li>
<li><p><strong>nepisodes</strong> (<em>int</em>) – number of episodes to be plotted.</p></li>
<li><p><strong>px</strong> – bool: if to plot x (input)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase.plot_train_features">
<span class="sig-name descname"><span class="pre">plot_train_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nepisodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase.plot_train_features" title="Permalink to this definition"></a></dt>
<dd><p>Calls <code class="xref py py-func docutils literal notranslate"><span class="pre">_plot_features()</span></code> with train data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<em>str</em>) – title of plot. If None, use ‘Training features’.</p></li>
<li><p><strong>nepisodes</strong> (<em>int</em>) – number of episodes to be plotted.</p></li>
<li><p><strong>px</strong> – bool: if to plot x (input)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase.plot_val">
<span class="sig-name descname"><span class="pre">plot_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nepisodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_normed_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase.plot_val" title="Permalink to this definition"></a></dt>
<dd><p>Calls <code class="xref py py-func docutils literal notranslate"><span class="pre">_plot_prediction()</span></code> with validation data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<em>str</em>) – title of plot. If None, use ‘Validation’.</p></li>
<li><p><strong>nepisodes</strong> (<em>int</em>) – number of episodes to be plotted.</p></li>
<li><p><strong>px</strong> – bool: if to plot x (input)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase.plot_val_features">
<span class="sig-name descname"><span class="pre">plot_val_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nepisodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase.plot_val_features" title="Permalink to this definition"></a></dt>
<dd><p>Calls <code class="xref py py-func docutils literal notranslate"><span class="pre">_plot_features()</span></code> with val data.
:param title: title of plot. If None, use ‘Training features’.
:type title: str
:param nepisodes: number of episodes to be plotted.
:type nepisodes: int
:param px: bool: if to plot x (input)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase.plot_worst_val_episodes">
<span class="sig-name descname"><span class="pre">plot_worst_val_episodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nepisodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_normed_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase.plot_worst_val_episodes" title="Permalink to this definition"></a></dt>
<dd><p>Calls <code class="xref py py-func docutils literal notranslate"><span class="pre">_plot_prediction()</span></code> with the episodes in the validation data that have the largest MSE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<em>str</em>) – title of plot. If None, use ‘Validation’.</p></li>
<li><p><strong>nepisodes</strong> (<em>int</em>) – number of episodes to be plotted.</p></li>
<li><p><strong>px</strong> – bool: if to plot x (input)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase.print_results">
<span class="sig-name descname"><span class="pre">print_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase.print_results" title="Permalink to this definition"></a></dt>
<dd><p>Print prediction metrics to console.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> (<em>dict</em>) – Dictionary of results. If None, use self.get_results().</p></li>
<li><p><strong>full</strong> (<em>bool</em>) – If True, print all metrics. If False, print only nrmse and corr.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataobj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase.run" title="Permalink to this definition"></a></dt>
<dd><p>Setup, train, val, and evaluate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataobj</strong> (<a class="reference internal" href="#src.data.DataSource" title="src.data.DataSource"><em>DataSource</em></a>) – Instance of DataSource class.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.PredictionModelBase.show_worst_val_episodes">
<span class="sig-name descname"><span class="pre">show_worst_val_episodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nepisodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.PredictionModelBase.show_worst_val_episodes" title="Permalink to this definition"></a></dt>
<dd><p>Plot and return the validation episodes with the worst (highest) MSE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot</strong> (<em>bool</em>) – If True, plot the episodes.</p></li>
<li><p><strong>nepisodes</strong> (<em>int</em>) – Number of episodes to plot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>episode number and MSE. shape(episodes, 2).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>train_errors, val_errors (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.basemodel.QuantumBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.basemodel.</span></span><span class="sig-name descname"><span class="pre">QuantumBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nqubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qctype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qinit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlayers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enctype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encangle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nenccopies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encaxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measaxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_precision</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_jmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_wmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_random</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_jpositive</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_wpositive</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.QuantumBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for quantum circuits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nqubits</strong> (<em>int</em>) – number of qubits</p></li>
<li><p><strong>qinit</strong> (<em>str</em>) – initialize qubit states before first step.
‘h’: Hadamard</p></li>
<li><p><strong>nlayers</strong> (<em>int</em>) – number of unitaries at each step.</p></li>
<li><p><strong>ftype</strong> (<em>int</em>) – <div class="line-block">
<div class="line">which expectation values from circuit measurements to use as features.</div>
<div class="line">-1: all of the below.</div>
<div class="line">0: probability vector of possible bitstrings</div>
<div class="line-block">
<div class="line">(dimf = 2^n, n = num measured qubits).</div>
</div>
<div class="line">1: single qubit expectations &lt;z&gt;</div>
<div class="line-block">
<div class="line">(dimf = n).</div>
</div>
<div class="line">2: two qubit expectations &lt;zz&gt;</div>
<div class="line-block">
<div class="line">(dimf = (n choose 2)). also includes 1.</div>
</div>
<div class="line">3: three qubit expectations &lt;zzz&gt;</div>
<div class="line-block">
<div class="line">(dimf = (n choose 3)). also includes 1 and 2.</div>
</div>
<div class="line">4: four qubit expectations &lt;zzzz&gt;</div>
<div class="line-block">
<div class="line">(dimf = (n choose 4)). also includes 1, 2, and 3.</div>
</div>
</div>
</p></li>
<li><p><strong>qctype</strong> (<em>str</em>) – <div class="line-block">
<div class="line">ising, ising_nn, ising_ladder, random, random_hpcnot, random_clifford, random_ht, jiri, spread_input, hcnot, circularcnot, downup, efficientsu2, swapstack, empty, mockqc.</div>
<div class="line">ising: fully connected transverse field ising model from <code class="xref py py-func docutils literal notranslate"><span class="pre">circuits.ising_circuit()</span></code>.</div>
<div class="line">ising_nn: nearest neighbour connection</div>
<div class="line">ising_ladder: ladder up and down</div>
<div class="line-block">
<div class="line">ising_t (float): time in e^-iHt</div>
<div class="line">ising_jmax (float): J in (-jmax, jmax) (spin-spin couplings)</div>
<div class="line">ising_wmax (float): D in (-wmax, wmax) (disorder strength)</div>
<div class="line">ising_h (float): h (transverse field)</div>
<div class="line">ising_random (bool): if True, random J, D</div>
</div>
<div class="line">See <code class="xref py py-mod docutils literal notranslate"><span class="pre">circuits</span></code> for details.</div>
</div>
</p></li>
<li><p><strong>shots</strong> (<em>int</em><em>) </em><em>= 2^13</em><em> (</em><em>8192</em>) – number of shots for measurement.</p></li>
<li><p><strong>sim</strong> (<em>str</em>) – simulator for quantum circuit.
‘aer_simulator’ for a noiseless simulation.
Can be anything in
<code class="code docutils literal notranslate"><span class="pre">available_backends</span> <span class="pre">=</span> <span class="pre">{b.name():b.configuration().n_qubits</span> <span class="pre">for</span> <span class="pre">b</span> <span class="pre">in</span> <span class="pre">FakeProvider().backends()}</span></code> for a noisy circuit.
‘thermal’ for the noisy <code class="xref py py-func docutils literal notranslate"><span class="pre">noisemodel.thermal_model()</span></code> (faster than the backends from FakeProvider).</p></li>
<li><p><strong>t1</strong> (<em>float</em>) – if sim=thermal, mean T1 value in microseconds. mean T2 = 7/5 mean T1. Default: 50.</p></li>
<li><p><strong>sim_precision</strong> (<em>str</em>) – precision of simulator.</p></li>
<li><p><strong>enctype</strong> (<em>str</em>) – <div class="line-block">
<div class="line">‘angle’: <span class="math notranslate nohighlight">\(Rx(x) |0&gt; = cos(x/2) |0&gt; + sin(x/2) |1&gt;\)</span>, x in (0, Pi).</div>
<div class="line">’ryrz’: <span class="math notranslate nohighlight">\(Rz(x^2 + Pi/4) Ry(x + Pi/4) |+&gt;\)</span>, x in (0, Pi).</div>
</div>
</p></li>
<li><p><strong>encangle</strong> (<em>float</em>) – if=1, x is in (0, Pi).</p></li>
<li><p><strong>nenccopies</strong> (<em>int</em>) – number of copies of the input to be input into the circuit in parallel at each step.</p></li>
<li><p><strong>encaxes</strong> (<em>str</em>) – axes for encoding. If nenccopies=1, only the first character is used.</p></li>
<li><p><strong>measaxes</strong> (<em>str</em>) – axes for measurement. If three characters, circuit is run 3*shots times.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.QuantumBase._add_input_to_qc">
<span class="sig-name descname"><span class="pre">_add_input_to_qc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#src.basemodel.QuantumBase._add_input_to_qc" title="Permalink to this definition"></a></dt>
<dd><p>Encode input onto circuit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qc</strong> (<em>QuantumCircuit</em>) – circuit to add input to</p></li>
<li><p><strong>angles</strong> (<em>ndarray</em><em>(</em><em>steps</em><em>, </em><em>dimx</em><em>)</em>) – encoded input data</p></li>
<li><p><strong>step</strong> (<em>int</em>) – current step. Used to index angles, 0 indexed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.QuantumBase._angle_encoding">
<span class="sig-name descname"><span class="pre">_angle_encoding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">episode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.QuantumBase._angle_encoding" title="Permalink to this definition"></a></dt>
<dd><p>Encode episode into range (0, pi).
If using multiple encoding copies nenccopies &gt; 1, only feed in the first copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>episode</strong> (<em>ndarray</em><em>(</em><em>steps</em><em>, </em><em>dimx</em><em>)</em>) – input data</p></li>
<li><p><strong>dmin</strong> (<em>list</em><em> or </em><em>ndarray</em><em>(</em><em>dimx</em><em>)</em>) – min value in episode. defaults to xmin</p></li>
<li><p><strong>dmax</strong> (<em>list</em><em> or </em><em>ndarray</em><em>(</em><em>dimx</em><em>)</em>) – max value in episode. defaults to xmax</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Same shape as episode</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>encoded_input (ndarray(steps, dimx))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.QuantumBase._binary_encoding">
<span class="sig-name descname"><span class="pre">_binary_encoding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">episode</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.QuantumBase._binary_encoding" title="Permalink to this definition"></a></dt>
<dd><p>Encode x sequence into binary {0, pi}.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>episode</strong> (<em>ndarray</em><em>(</em><em>steps</em><em>, </em><em>dimx</em><em>)</em>) – input data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Same shape as episode</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>binary (ndarray(steps, dimx))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.QuantumBase._get_circuit_measurements">
<span class="sig-name descname"><span class="pre">_get_circuit_measurements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qc</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#src.basemodel.QuantumBase._get_circuit_measurements" title="Permalink to this definition"></a></dt>
<dd><p>Transpile and run circuit on simulator.
:param qc: circuit to measure
:type qc: QuantumCircuit</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Counts of measurements (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.QuantumBase._set_unitary">
<span class="sig-name descname"><span class="pre">_set_unitary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.QuantumBase._set_unitary" title="Permalink to this definition"></a></dt>
<dd><p>Set the unitary for each timestep (self.unistep).
Just calls the appropriate function from <code class="xref py py-mod docutils literal notranslate"><span class="pre">circuits</span></code> based on self.qctype.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.QuantumBase._step_meas_to_step_features">
<span class="sig-name descname"><span class="pre">_step_meas_to_step_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">counts_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.QuantumBase._step_meas_to_step_features" title="Permalink to this definition"></a></dt>
<dd><p>Expectation values of measurements are appended to features_step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>counts_step</strong> (<em>dict</em>) – counts which are shall be processed to features</p></li>
<li><p><strong>features_step</strong> (<em>list</em>) – features are appended to this list</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>features_step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.QuantumBase._step_meas_to_step_features_sv">
<span class="sig-name descname"><span class="pre">_step_meas_to_step_features_sv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.QuantumBase._step_meas_to_step_features_sv" title="Permalink to this definition"></a></dt>
<dd><p>Expectation values of a statevector are appended to features_step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sv</strong> (<em>qi.Statevector</em>) – statevector which are shall be processed to features</p></li>
<li><p><strong>features_step</strong> (<em>list</em>) – features are appended to this list</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>features_step</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.basemodel.StepwiseModelBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.basemodel.</span></span><span class="sig-name descname"><span class="pre">StepwiseModelBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyoffset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_past_y_to_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_true_y_in_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lookback_max</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.StepwiseModelBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Provides training loop for <a class="reference internal" href="#src.feedforward.CPolynomialFeedforward" title="src.feedforward.CPolynomialFeedforward"><code class="xref py py-class docutils literal notranslate"><span class="pre">src.feedforward.CPolynomialFeedforward</span></code></a>
and <a class="reference internal" href="#src.feedforward.QExtremeLearningMachine" title="src.feedforward.QExtremeLearningMachine"><code class="xref py py-class docutils literal notranslate"><span class="pre">src.feedforward.QExtremeLearningMachine</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyoffset</strong> (<em>int 0</em><em> or </em><em>1</em>) – <div class="line-block">
<div class="line">Number of steps to offset x and y.</div>
<div class="line">Set to 1 for NARMA and reactor data.</div>
<div class="line">xyoffset=0: <span class="math notranslate nohighlight">\(y_t = f(x_t, y_{t-1})\)</span></div>
<div class="line">xyoffset=1: <span class="math notranslate nohighlight">\(y_{t+1} = f(x_t, y_t)\)</span></div>
</div>
</p></li>
<li><p><strong>set_past_y_to_0</strong> (<em>bool</em>) – When using y(t&lt;0) values as input for the first few steps, set y(t&lt;0)=0 or y(t&lt;0)=y(0).</p></li>
<li><p><strong>use_true_y_in_val</strong> (<em>bool</em>) – <div class="line-block">
<div class="line">Option for debugging or evaluating the model.</div>
<div class="line">If the model takes in previously predicited (possible wrong) y as input,</div>
<div class="line">error can accumulate over time (drift).</div>
<div class="line">True: use true previous y values in validation.</div>
<div class="line">Should lead to mse_train=mse_val if combined with DataSource(train_equal_val=True).</div>
</div>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.StepwiseModelBase._get_input_t">
<span class="sig-name descname"><span class="pre">_get_input_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xe_lookback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ye_lookback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.StepwiseModelBase._get_input_t" title="Permalink to this definition"></a></dt>
<dd><p>Get input for this step from lookup tables.</p>
<dl class="simple">
<dt>Indices:</dt><dd><p>x[t_in:t_in+self.xlooback]
y[t_in:t_in+self.xlooback]</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xe_lookback</strong> (<em>nd.array</em>) – lookup table for past actions in this episode. shape(steps_max, dimx).</p></li>
<li><p><strong>ye_lookback</strong> (<em>nd.array</em>) – lookup table for past outputs in this episode. shape(steps_max, dimy).</p></li>
<li><p><strong>t_pred</strong> (<em>int</em>) – timestep to be predicted.</p></li>
<li><p><strong>t_in</strong> (<em>int</em>) – step in loop.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.StepwiseModelBase._init_t_inputs">
<span class="sig-name descname"><span class="pre">_init_t_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_max</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.StepwiseModelBase._init_t_inputs" title="Permalink to this definition"></a></dt>
<dd><p>Lookup table of past x and y values to repeat the past steps.</p>
<p>It’s own class in order to assure that train and val are doing the same thing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> – first steps in this episode</p></li>
<li><p><strong>y0</strong> – first steps in this episode</p></li>
<li><p><strong>steps_max</strong> – maximum number of steps in this episode</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>xe_lookback, ye_lookback (np.array(steps_max+lookback, dim))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.StepwiseModelBase._t_input_to_t_features">
<span class="sig-name descname"><span class="pre">_t_input_to_t_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.StepwiseModelBase._t_input_to_t_features" title="Permalink to this definition"></a></dt>
<dd><p>Features for this steps, given some input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_t</strong> (<em>nd.array</em>) – inputs for this step. shape(1, any).</p></li>
<li><p><strong>x0</strong> (<em>nd.array</em><em>)</em><em>. current x. gets added as feature. shape</em><em>(</em><em>1</em><em>, </em><em>dimx</em>) – </p></li>
<li><p><strong>t_pred</strong> (<em>int</em>) – optional. in some model used to save the circuit at a specific step.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.StepwiseModelBase.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.StepwiseModelBase.train" title="Permalink to this definition"></a></dt>
<dd><p>Train the model on the training data for all episodes.</p>
<p>Run model for all steps and collect features.
If model takes in y as input, then use true y.
After all steps and episodes, train linear fitter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.basemodel.StepwiseModelBase.val">
<span class="sig-name descname"><span class="pre">val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nepisodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.basemodel.StepwiseModelBase.val" title="Permalink to this definition"></a></dt>
<dd><p>Train for all episodes.</p>
<p>Run model for one step, predict y(t+1) from features.
If model takes in y as input, then use predicted (possibly wrong) y.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-src.circuits">
<span id="src-circuits-module"></span><h2>src.circuits module<a class="headerlink" href="#module-src.circuits" title="Permalink to this heading"></a></h2>
<p>Quantum Circuits to be used as fixed unitaries in the quantum reservoir computing.</p>
<p>The only one that is working in practice is <a class="reference internal" href="#src.circuits.ising_circuit" title="src.circuits.ising_circuit"><code class="xref py py-func docutils literal notranslate"><span class="pre">ising_circuit()</span></code></a> at the moment.
Most of the other circuits were inspired by VQC Ansaetze.</p>
<dl class="py function">
<dt class="sig sig-object py" id="src.circuits.circularcnot_circuit">
<span class="sig-prename descclassname"><span class="pre">src.circuits.</span></span><span class="sig-name descname"><span class="pre">circularcnot_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nqubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.circuits.circularcnot_circuit" title="Permalink to this definition"></a></dt>
<dd><p>Nearest-neighbor cnots staircase + last qubit connecting back to first qubit.</p>
<p>Inspired by:
Studying quantum algorithms for particle track reconstruction in the LUXE experiment</p>
<p><a class="reference external" href="https://www.researchgate.net/figure/Layout-of-the-variational-quantum-circuit-using-the-TwoLocal-ansatz-with-R-Y-gates-and-a_fig1_358604035">https://www.researchgate.net/figure/Layout-of-the-variational-quantum-circuit-using-the-TwoLocal-ansatz-with-R-Y-gates-and-a_fig1_358604035</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nqubits</strong> (<em>int</em>) – number of qubits</p></li>
<li><p><strong>rseed</strong> (<em>int</em>) – random seed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>QuantumCircuit</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.circuits.downup_circuit">
<span class="sig-prename descclassname"><span class="pre">src.circuits.</span></span><span class="sig-name descname"><span class="pre">downup_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nqubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.circuits.downup_circuit" title="Permalink to this definition"></a></dt>
<dd><p>H on qin, cnot staircase down, random rz on all qubits, cnot staircase up.</p>
<p>This is a circuit that is used in the qiskit tutorial:
<a class="reference external" href="https://qiskit.org/documentation/tutorials/circuits_advanced/01_advanced_circuits.html">https://qiskit.org/documentation/tutorials/circuits_advanced/01_advanced_circuits.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nqubits</strong> (<em>int</em>) – number of qubits</p></li>
<li><p><strong>qin</strong> (<em>int</em><em> | </em><em>list</em>) – index of qubit to apply H to</p></li>
<li><p><strong>rseed</strong> (<em>int</em>) – random seed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>QuantumCircuit</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.circuits.efficientsu2_circuit">
<span class="sig-prename descclassname"><span class="pre">src.circuits.</span></span><span class="sig-name descname"><span class="pre">efficientsu2_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nqubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.circuits.efficientsu2_circuit" title="Permalink to this definition"></a></dt>
<dd><p>EfficientSU2 circuit from qiskit with random parameters
<a class="reference external" href="https://qiskit.org/documentation/stubs/qiskit.circuit.library.EfficientSU2.html">https://qiskit.org/documentation/stubs/qiskit.circuit.library.EfficientSU2.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nqubits</strong> (<em>int</em>) – number of qubits</p></li>
<li><p><strong>rseed</strong> (<em>int</em>) – random seed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>QuantumCircuit</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.circuits.fake_circuit">
<span class="sig-prename descclassname"><span class="pre">src.circuits.</span></span><span class="sig-name descname"><span class="pre">fake_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nqubits</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.circuits.fake_circuit" title="Permalink to this definition"></a></dt>
<dd><p>Empty circuit with label for drawing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nqubits</strong> (<em>int</em>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>QuantumCircuit</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.circuits.hcnot_circuit">
<span class="sig-prename descclassname"><span class="pre">src.circuits.</span></span><span class="sig-name descname"><span class="pre">hcnot_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nqubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.circuits.hcnot_circuit" title="Permalink to this definition"></a></dt>
<dd><p>One of h, ry, rz on every qubit. cnot on every pair of qubits (fully connected).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nqubits</strong> (<em>int</em>) – number of qubits</p></li>
<li><p><strong>rseed</strong> (<em>int</em>) – random seed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>QuantumCircuit</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.circuits.ising_circuit">
<span class="sig-prename descclassname"><span class="pre">src.circuits.</span></span><span class="sig-name descname"><span class="pre">ising_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nqubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jpositive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wpositive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.circuits.ising_circuit" title="Permalink to this definition"></a></dt>
<dd><p>Transverse field ising model.</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}H = J X X + (h + D) Z \\\end{split}\\U = e^{-iHt} ~ e^{-iJXXt} e^{-i(h+W)Zt} = Rxx(2Jt) Rz(2(h+W)t)\end{aligned}\end{align} \]</div>
<p><a class="reference external" href="https://arxiv.org/pdf/2103.05348.pdf">https://arxiv.org/pdf/2103.05348.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nqubits</strong> (<em>int</em>) – number of qubits</p></li>
<li><p><strong>t</strong> (<em>float</em>) – time in e^-iHt</p></li>
<li><p><strong>h</strong> (<em>float</em>) – fixed magnetic field</p></li>
<li><p><strong>jmax</strong> (<em>float</em>) – spin-spin coupling J in (-jmax, jmax)</p></li>
<li><p><strong>jpositive</strong> (<em>bool</em>) – J in (0, jmax)</p></li>
<li><p><strong>wmax</strong> (<em>float</em>) – onsite disorder strength W in (-wmax, wmax)</p></li>
<li><p><strong>wpositive</strong> (<em>bool</em>) – D in (0, jmax)</p></li>
<li><p><strong>random</strong> (<em>bool</em>) – if false, J=jmax and W=wmax</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – <div class="line-block">
<div class="line">‘nn’: Rxx on nearest neighbour, and Rz.</div>
<div class="line">’up_ladder’: Rxx ladder from qubit 0 to qubit max, and Rz.</div>
<div class="line">’up_down_ladder’: Rxx ladder from qubit 0 to qubit max, Rz, Rxx ladder from qubit max to qubit 0.</div>
<div class="line">else: Rxx on all pairwise connections, and Rz.</div>
</div>
</p></li>
<li><p><strong>rseed</strong> (<em>int</em>) – random seed for picking J, W</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>QuantumCircuit</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.circuits.jiri_circuit">
<span class="sig-prename descclassname"><span class="pre">src.circuits.</span></span><span class="sig-name descname"><span class="pre">jiri_circuit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.circuits.jiri_circuit" title="Permalink to this definition"></a></dt>
<dd><p>For 3 qubits.
Just somewhat arbitrarily generated circuit from universal gates (p, h, cx).
By Jirka Guth Jarkovsky.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>3-qubit QuantumCircuit</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.circuits.jiri_circuit_weak_measurement">
<span class="sig-prename descclassname"><span class="pre">src.circuits.</span></span><span class="sig-name descname"><span class="pre">jiri_circuit_weak_measurement</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.circuits.jiri_circuit_weak_measurement" title="Permalink to this definition"></a></dt>
<dd><p>3 qubit unitary with weak measurements on qubit 0 and 1 using two extra ancillas.</p>
<div class="line-block">
<div class="line">Unitary is the same as in <a class="reference internal" href="#src.circuits.jiri_circuit" title="src.circuits.jiri_circuit"><code class="xref py py-func docutils literal notranslate"><span class="pre">jiri_circuit()</span></code></a></div>
<div class="line">Weak measurement is the same as <a class="reference internal" href="#src.circuits.weak_measurement_circuit" title="src.circuits.weak_measurement_circuit"><code class="xref py py-func docutils literal notranslate"><span class="pre">weak_measurement_circuit()</span></code></a></div>
</div>
<p>By Jirka Guth Jarkovsky.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>5-qubit QuantumCircuit</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.circuits.random_circuit">
<span class="sig-prename descclassname"><span class="pre">src.circuits.</span></span><span class="sig-name descname"><span class="pre">random_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nqubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.circuits.random_circuit" title="Permalink to this definition"></a></dt>
<dd><p>h, rx, ry, rz, p, cnot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nqubits</strong> (<em>int</em>) – number of qubits</p></li>
<li><p><strong>ngates</strong> (<em>int</em>) – number of gates</p></li>
<li><p><strong>rseed</strong> (<em>int</em>) – random seed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>QuantumCircuit</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.circuits.random_clifford_circuit">
<span class="sig-prename descclassname"><span class="pre">src.circuits.</span></span><span class="sig-name descname"><span class="pre">random_clifford_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nqubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.circuits.random_clifford_circuit" title="Permalink to this definition"></a></dt>
<dd><p>h, s, t, cnot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nqubits</strong> (<em>int</em>) – number of qubits</p></li>
<li><p><strong>ngates</strong> (<em>int</em>) – number of gates</p></li>
<li><p><strong>rseed</strong> (<em>int</em>) – random seed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>QuantumCircuit</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.circuits.random_hpcnot_circuit">
<span class="sig-prename descclassname"><span class="pre">src.circuits.</span></span><span class="sig-name descname"><span class="pre">random_hpcnot_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nqubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.circuits.random_hpcnot_circuit" title="Permalink to this definition"></a></dt>
<dd><p>h, p, cnot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nqubits</strong> (<em>int</em>) – number of qubits</p></li>
<li><p><strong>ngates</strong> (<em>int</em>) – number of gates</p></li>
<li><p><strong>rseed</strong> (<em>int</em>) – random seed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>QuantumCircuit</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.circuits.random_ht_circuit">
<span class="sig-prename descclassname"><span class="pre">src.circuits.</span></span><span class="sig-name descname"><span class="pre">random_ht_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nqubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.circuits.random_ht_circuit" title="Permalink to this definition"></a></dt>
<dd><p>h, tiffoli.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nqubits</strong> (<em>int</em>) – number of qubits</p></li>
<li><p><strong>ngates</strong> (<em>int</em>) – number of gates</p></li>
<li><p><strong>rseed</strong> (<em>int</em>) – random seed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>QuantumCircuit</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.circuits.spread_circuit">
<span class="sig-prename descclassname"><span class="pre">src.circuits.</span></span><span class="sig-name descname"><span class="pre">spread_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nqubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sources</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.circuits.spread_circuit" title="Permalink to this definition"></a></dt>
<dd><p>Input connected to all others via a direct cnot</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.circuits.weak_measurement_circuit">
<span class="sig-prename descclassname"><span class="pre">src.circuits.</span></span><span class="sig-name descname"><span class="pre">weak_measurement_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qwm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unitary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmangle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.25</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.circuits.weak_measurement_circuit" title="Permalink to this definition"></a></dt>
<dd><p>Quantum circuit with weak measurement on qubits qwm using ancillas.</p>
<div class="line-block">
<div class="line">Weak measurement:</div>
<div class="line">1. apply H to get the ancilla in a state <span class="math notranslate nohighlight">\(|+&gt;\)</span></div>
<div class="line">2. Slightly rotate along the y axis (Ry) to get a state <span class="math notranslate nohighlight">\(\sqrt{1/2+e}|0&gt; + sqrt{1/2-e}|1&gt;\)</span></div>
<div class="line">3. CNOT to change into <span class="math notranslate nohighlight">\(\sqrt{1/2+e}|1&gt; + \sqrt{1/2-e}|0&gt;\)</span></div>
</div>
<p>By Jirka Guth Jarkovsky.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qwm</strong> (<em>list</em>) – qubits to be weakly measured</p></li>
<li><p><strong>unitary</strong> (<em>QuantumCircuit</em>) – unitary to be applied to be (partly) weakly measured</p></li>
<li><p><strong>wmangle</strong> (<em>float</em>) – angle for Ry in the weak measurement.
=Pi/2 is basically a strong measurement,
since the ancilla will be in <span class="math notranslate nohighlight">\(|1&gt;\)</span> before the cnot and perfectly
correlated with the observed qubit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>QuantumCircuit with qwm + unitary qubits</p>
</dd>
</dl>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="n">weak_measurement_circuit</span><span class="p">(</span><span class="n">qwm</span><span class="p">,</span> <span class="n">unitary</span><span class="p">)</span>
<span class="n">qanc</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">unitary</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">,</span> <span class="n">qc</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)]</span>
<span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">qanc</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-src.continuous">
<span id="src-continuous-module"></span><h2>src.continuous module<a class="headerlink" href="#module-src.continuous" title="Permalink to this heading"></a></h2>
<p>Contains <a class="reference internal" href="#src.continuous.QContinuousRC" title="src.continuous.QContinuousRC"><code class="xref py py-class docutils literal notranslate"><span class="pre">QContinuousRC</span></code></a> and <a class="reference internal" href="#src.continuous.NaivePredictor" title="src.continuous.NaivePredictor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NaivePredictor</span></code></a>.</p>
<p><a class="reference internal" href="#src.continuous.QContinuousRC" title="src.continuous.QContinuousRC"><code class="xref py py-class docutils literal notranslate"><span class="pre">QContinuousRC</span></code></a> is a reservoir computer which constructs one circuit spanning all timesteps.
Thus all inputs need to be known beforehand, and predictions of previous timesteps cannot be fed in again.
This is sometimes called online reservoir computing.</p>
<p>It is not suitable for the Reactor data, or Narma.
In theory it can do the short term memory task, but in practice it does not work well.
It works a little when using ancilla qubits for weak measurement, but not well enough to be useful.
I think the best way to make an online reservoir work is to use weak measurement simulations,
see <a class="reference external" href="https://www.nature.com/articles/s41534-023-00682-z">https://www.nature.com/articles/s41534-023-00682-z</a></p>
<p><a class="reference internal" href="#src.continuous.NaivePredictor" title="src.continuous.NaivePredictor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NaivePredictor</span></code></a> is a simple predictor which does not use a quantum circuit.
It can be used as a comparison, altough a better benchmark model is <a class="reference internal" href="#src.feedforward.CPolynomialFeedforward" title="src.feedforward.CPolynomialFeedforward"><code class="xref py py-class docutils literal notranslate"><span class="pre">src.feedforward.CPolynomialFeedforward</span></code></a>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="src.continuous.NaivePredictor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.continuous.</span></span><span class="sig-name descname"><span class="pre">NaivePredictor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'naive'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.continuous.NaivePredictor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.basemodel.PredictionModelBase" title="src.basemodel.PredictionModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">PredictionModelBase</span></code></a></p>
<p>Simple prediction to compare the Reservoir + Linear System (OLS) Solver to.</p>
<p>NaivePredictor does not look at input sequence (x),
but makes simple guesses based on previous target (y) steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pred_type</strong> (<em>str</em>) – <div class="line-block">
<div class="line">naive:</div>
<div class="line-block">
<div class="line">Predict that sequence won’t change.</div>
<div class="line"><span class="math notranslate nohighlight">\(y_t = y_{t-1}\)</span></div>
</div>
<div class="line">mean:</div>
<div class="line-block">
<div class="line">Predict that sequence is the mean.</div>
<div class="line">Technically cheating since it uses y(t) of future timesteps.</div>
<div class="line"><span class="math notranslate nohighlight">\(y_t = 1/N \sum_{i=0}^{N-1} y_{i}\)</span></div>
</div>
<div class="line">prevmean:</div>
<div class="line-block">
<div class="line">Predict that sequence is the mean of previous timesteps.</div>
<div class="line"><span class="math notranslate nohighlight">\(y_t = 1/N \sum_{i=0}^{t} y_{i}\)</span></div>
</div>
</div>
</p>
</dd>
</dl>
<p>Additional arguments are passed to <a class="reference internal" href="#src.basemodel.PredictionModelBase" title="src.basemodel.PredictionModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">src.basemodel.PredictionModelBase</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.continuous.NaivePredictor._predict">
<span class="sig-name descname"><span class="pre">_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.continuous.NaivePredictor._predict" title="Permalink to this definition"></a></dt>
<dd><p>Predicts y from y (one episode).
:param y: np.array (steps, dimy)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array (steps, dimy)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ypred</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.continuous.NaivePredictor._set_unitary_and_meas">
<span class="sig-name descname"><span class="pre">_set_unitary_and_meas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.continuous.NaivePredictor._set_unitary_and_meas" title="Permalink to this definition"></a></dt>
<dd><p>NaivePredictor does not use a quantum circuit.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.continuous.NaivePredictor.model_name">
<span class="sig-name descname"><span class="pre">model_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'baseline_prediction'</span></em><a class="headerlink" href="#src.continuous.NaivePredictor.model_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.continuous.NaivePredictor.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.continuous.NaivePredictor.train" title="Permalink to this definition"></a></dt>
<dd><p>Train is the same as val (class has no trainable parameters).
:param y: list of episodes</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of predictions (list) (episodes, steps, dimy)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.continuous.NaivePredictor.val">
<span class="sig-name descname"><span class="pre">val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.continuous.NaivePredictor.val" title="Permalink to this definition"></a></dt>
<dd><p>Train is the same as val (class has no trainable parameters).
:param y: list(np.array) (episodes, steps, dimy)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list(np.array) (episodes, steps, dimy)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>predictions</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.continuous.QContinuousRC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.continuous.</span></span><span class="sig-name descname"><span class="pre">QContinuousRC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preloading</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'projection'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmeas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reseti</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resetm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weak_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">washout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_x_as_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nyfuture</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_future_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sklearn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ridge'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_l1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nqubits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ising'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlayers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'angle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nenccopies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encangle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_jmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_wmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_random</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_jpositive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_wpositive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'aer_simulator'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'statevector'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.continuous.QContinuousRC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.basemodel.PredictionModelBase" title="src.basemodel.PredictionModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">PredictionModelBase</span></code></a>, <a class="reference internal" href="#src.basemodel.QuantumBase" title="src.basemodel.QuantumBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumBase</span></code></a></p>
<p>Continous (online) reservoir.</p>
<p>Takes all actions x(t) as given and constructs one circuit spanning all timesteps t.
Inputs current x(t) and partially measures the circuit at each step t.
The results of the measurements are the features f(t).
After all training steps, f(t) are fitted to y(t) via an Ordinary Linear System fitter.</p>
<p>Qubits which aren’t measured act as a kind of memory of past steps.</p>
<p>Only takes in x (not y). Can theoretically do Narma, but not Reactor.
Does not work well in practice.</p>
<div class="math notranslate nohighlight">
\[y_t = f(x_t, ..., x_0)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>washout</strong> (<em>int</em>) – number of first steps of episode ignored by fitting/error metrics.</p></li>
<li><p><strong>preloading</strong> (<em>int</em>) – number of times the first step is repeated before episode actually starts</p></li>
<li><p><strong>qctype</strong> (<em>str</em>) – random, random_hpcnot, random_ht, random_clifford, circularcnot,
hcnot, spread_input, efficientsu2, downup, lstmv1, lstmv2, random_esn, empty</p></li>
<li><p><strong>mtype</strong> (<em>str</em>) – <div class="line-block">
<div class="line">projection:</div>
<div class="line">weak: weak measurement using ancilla qubits. See <code class="xref py py-func docutils literal notranslate"><span class="pre">circuits.weak_measurement_circuit()</span></code>.</div>
<div class="line-block">
<div class="line">weak_angle (float) = .1: weak measurement angle. Gets multiplied by Pi/2.</div>
<div class="line">=1 is a cnot from observed to ancilla qubit and basically a strong measurement.</div>
</div>
</div>
</p></li>
<li><p><strong>nmeas</strong> (<em>int</em>) – number of qubits measured at each step.</p></li>
<li><p><strong>minc</strong> (<em>bool</em>) – When selecting qubits to measure, prioritise qubits which encode x</p></li>
<li><p><strong>mend</strong> (<em>bool</em>) – When selecting qubits to measure, prioritise qubits on the far side of the encoding qubits</p></li>
<li><p><strong>resetm</strong> (<em>bool</em>) – Reset qubits after measurement</p></li>
<li><p><strong>reseti</strong> (<em>bool</em>) – Reset qubits before input</p></li>
</ul>
</dd>
</dl>
<p>Additional arguments are passed to <a class="reference internal" href="#src.basemodel.PredictionModelBase" title="src.basemodel.PredictionModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">src.basemodel.PredictionModelBase</span></code></a> and <a class="reference internal" href="#src.basemodel.QuantumBase" title="src.basemodel.QuantumBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">src.basemodel.QuantumBase</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.continuous.QContinuousRC._build_episode_circuit">
<span class="sig-name descname"><span class="pre">_build_episode_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unistep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">barriers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.continuous.QContinuousRC._build_episode_circuit" title="Permalink to this definition"></a></dt>
<dd><p>Circuit for one episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unistep</strong> (<em>QuantumCircuit</em>) – unitary for one timestep</p></li>
<li><p><strong>angles</strong> (<em>list</em><em>[</em><em>np.array</em><em>]</em>) – list of angles which encode input of this episode (step, dimx)</p></li>
<li><p><strong>measax</strong> (<em>str</em>) – x,y,z. axis of measurement.</p></li>
<li><p><strong>steps</strong> (<em>int</em>) – number of timesteps in this episode. Defaults to number of rows in angles.</p></li>
<li><p><strong>barriers</strong> (<em>bool</em>) – add barriers between steps to make circuit illustrations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.continuous.QContinuousRC._get_all_episode_features">
<span class="sig-name descname"><span class="pre">_get_all_episode_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.continuous.QContinuousRC._get_all_episode_features" title="Permalink to this definition"></a></dt>
<dd><p>Build, run, and get output from quantum circuit reservoir for all episodes.</p>
<p>Can use preloading. Returns features with washout period but without preloading steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – list[np.array]: list of episodes (episodes, steps, dimx).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list[np.array]:  list of means of measurements (episodes, steps, dimf)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>features</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.continuous.QContinuousRC._set_unitary_and_meas">
<span class="sig-name descname"><span class="pre">_set_unitary_and_meas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.continuous.QContinuousRC._set_unitary_and_meas" title="Permalink to this definition"></a></dt>
<dd><p>Define quantum circuit at every timestep.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>unitary at every timestep.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>self.unistep (qiskit.QuantumCircuit)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.continuous.QContinuousRC.axis">
<span class="sig-name descname"><span class="pre">axis</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['z',</span> <span class="pre">'x',</span> <span class="pre">'y']</span></em><a class="headerlink" href="#src.continuous.QContinuousRC.axis" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.continuous.QContinuousRC.illustrate_circuit">
<span class="sig-name descname"><span class="pre">illustrate_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dimx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mockqc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.continuous.QContinuousRC.illustrate_circuit" title="Permalink to this definition"></a></dt>
<dd><p>Schematic of circuit for first few timesteps.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.continuous.QContinuousRC.model_name">
<span class="sig-name descname"><span class="pre">model_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'online_reservoir'</span></em><a class="headerlink" href="#src.continuous.QContinuousRC.model_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.continuous.QContinuousRC.mtypes">
<span class="sig-name descname"><span class="pre">mtypes</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['projection',</span> <span class="pre">'weak']</span></em><a class="headerlink" href="#src.continuous.QContinuousRC.mtypes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.continuous.QContinuousRC.naxs">
<span class="sig-name descname"><span class="pre">naxs</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3]</span></em><a class="headerlink" href="#src.continuous.QContinuousRC.naxs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.continuous.QContinuousRC.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.continuous.QContinuousRC.train" title="Permalink to this definition"></a></dt>
<dd><p>Train the model on the training data for all episodes.</p>
<p>Run circuit for all steps and collect features.
If circuit takes in y as input, then use true y.
After all steps and episodes, train linear fitter.</p>
<dl class="simple">
<dt>Uses:</dt><dd><p>xtrain: list of episodes. list(np.array) (episodes, steps, dimx)
ytrain: list of episodes. list(np.array) (episodes, steps, dimy)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of predictions (episodes, steps, dimy)
list of features (reservoir circuit outputs) (episodes, steps, dimf)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.continuous.QContinuousRC.val">
<span class="sig-name descname"><span class="pre">val</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.continuous.QContinuousRC.val" title="Permalink to this definition"></a></dt>
<dd><p>Same as <code class="xref py py-func docutils literal notranslate"><span class="pre">train()</span></code> but weights are fixed.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-src.data">
<span id="src-data-module"></span><h2>src.data module<a class="headerlink" href="#module-src.data" title="Permalink to this heading"></a></h2>
<p>Contains <a class="reference internal" href="#src.data.DataSource" title="src.data.DataSource"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataSource</span></code></a>, which provides the training and testing data for the models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="src.data.DataSource">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.data.</span></span><span class="sig-name descname"><span class="pre">DataSource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nepisodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nvalepisodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tsetpoint'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'treactor'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xnorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'norm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ynorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'norm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_equal_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Provides training and validtion data.</p>
<p>Contains reactor data from Siemens and benchmark tasks like Narma and short term memory (STM).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nepisodes</strong> (<em>int</em>) – number of episodes for training</p></li>
<li><p><strong>nvalepisodes</strong> (<em>int</em>) – number of episodes for validating. If None set to 0.5*nepisodes.</p></li>
<li><p><strong>xtype</strong> (<em>str</em>) – tsetpoint or reactor, smooth, random, smoothfilter, binary, linear, constant</p></li>
<li><p><strong>ytype</strong> (<em>str</em>) – treactor or reactor, narma, stm, multiply, same</p></li>
<li><p><strong>mermory</strong> – order of time delay from x to y. for narma and stm.</p></li>
<li><p><strong>normx</strong> (<em>str</em>) – none, norm, std</p></li>
<li><p><strong>normy</strong> (<em>str</em>) – none, norm, std</p></li>
<li><p><strong>steps</strong> – number of steps per episode. Doesn’t apply to reactor data.</p></li>
<li><p><strong>train_equal_val</strong> (<em>bool</em>) – For debugging. Validation data is the same as the training data.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource._fix_input">
<span class="sig-name descname"><span class="pre">_fix_input</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource._fix_input" title="Permalink to this definition"></a></dt>
<dd><p>Fix parameters.</p>
<p>Set memory to 0 if its not needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource._generate_x_and_y">
<span class="sig-name descname"><span class="pre">_generate_x_and_y</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource._generate_x_and_y" title="Permalink to this definition"></a></dt>
<dd><p>Generate x and y.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[np.array] (episodes, steps, dim_x)
y: list[np.array] (episodes, steps, dim_y)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>x</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource._normalize_data">
<span class="sig-name descname"><span class="pre">_normalize_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource._normalize_data" title="Permalink to this definition"></a></dt>
<dd><p>Input x y and return normalized x y.
Can be normalized, standardized, or nothing (original input).</p>
<dl class="simple">
<dt>Args, Returns:</dt><dd><p>x: list[np.array] (episodes, steps, dim_x)
y: list[np.array] (episodes, steps, dim_y)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource._train_val_split">
<span class="sig-name descname"><span class="pre">_train_val_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource._train_val_split" title="Permalink to this definition"></a></dt>
<dd><p>Split x and y into train and val sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – list[np.array] (episodes, steps, dim_x)</p></li>
<li><p><strong>y</strong> – list[np.array] (episodes, steps, dim_y)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list[np.array] (episodes, steps, dim)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xtrain, ytrain, xval, yval</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource._x_narma_random">
<span class="sig-name descname"><span class="pre">_x_narma_random</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource._x_narma_random" title="Permalink to this definition"></a></dt>
<dd><p>Random input for NARMA task drawn from (0, 0.5).</p>
<p><a class="reference external" href="https://www.nature.com/articles/s41378-021-00313-7">https://www.nature.com/articles/s41378-021-00313-7</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[np.array] (episodes, steps, dim_x)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>x</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource._x_narma_smooth">
<span class="sig-name descname"><span class="pre">_x_narma_smooth</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource._x_narma_smooth" title="Permalink to this definition"></a></dt>
<dd><p>Smooth input for NARMA task.</p>
<p><a class="reference external" href="https://arxiv.org/pdf/2211.02612.pdf">https://arxiv.org/pdf/2211.02612.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[np.array] (episodes, steps, dim_x)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>x</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource._x_smoothfilter">
<span class="sig-name descname"><span class="pre">_x_smoothfilter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#src.data.DataSource._x_smoothfilter" title="Permalink to this definition"></a></dt>
<dd><p>By Andreas Burger.</p>
<p>A Savitzky-Golay filter and moving average applied to a
random sequence of floats uniformly picked from (0,1).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(episodes, steps, dim_x)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource._xy_reactor">
<span class="sig-name descname"><span class="pre">_xy_reactor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource._xy_reactor" title="Permalink to this definition"></a></dt>
<dd><p>Load raw reactor data from Siemens.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[np.array] (episodes, steps, dim_x)
y: list[np.array] (episodes, steps, dim_y)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>x</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource._y_narma">
<span class="sig-name descname"><span class="pre">_y_narma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource._y_narma" title="Permalink to this definition"></a></dt>
<dd><p>Nonlinear autoregressive moving average task.</p>
<p><a class="reference external" href="https://www.nature.com/articles/s41378-021-00313-7">https://www.nature.com/articles/s41378-021-00313-7</a>
<a class="reference external" href="https://arxiv.org/pdf/2211.02612.pdf">https://arxiv.org/pdf/2211.02612.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs</strong> (<em>list</em><em>[</em><em>np.array</em><em>]</em>) – (episodes, steps, dim_x)</p></li>
<li><p><strong>n</strong> (<em>int</em>) – correlation to past ~ memory length.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(episodes, steps, dim_y)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (list[np.array])</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.data.DataSource.data_path">
<span class="sig-name descname"><span class="pre">data_path</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'/Users/andreas-burger/RLCode/quantum-reinforcement-learning/qrc_surrogate/data/sprungversuche.h5'</span></em><a class="headerlink" href="#src.data.DataSource.data_path" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.data.DataSource.file_path">
<span class="sig-name descname"><span class="pre">file_path</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'/data/sprungversuche.h5'</span></em><a class="headerlink" href="#src.data.DataSource.file_path" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Get train-test-split.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>shape(episodes, steps, dim)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>xtrain, ytrain, xval, yval (list[np.array])</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource.get_dims">
<span class="sig-name descname"><span class="pre">get_dims</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource.get_dims" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource.get_dims_nonorm">
<span class="sig-name descname"><span class="pre">get_dims_nonorm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource.get_dims_nonorm" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource.get_hyperparameters">
<span class="sig-name descname"><span class="pre">get_hyperparameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource.get_hyperparameters" title="Permalink to this definition"></a></dt>
<dd><p>Return a dictionary of passable parameters and their current values.</p>
<p>Use to recreate instance</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_hyperparameters</span><span class="p">()</span>
<span class="n">model_copy</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.data.DataSource.module_path">
<span class="sig-name descname"><span class="pre">module_path</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'/Users/andreas-burger/RLCode/quantum-reinforcement-learning/qrc_surrogate'</span></em><a class="headerlink" href="#src.data.DataSource.module_path" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.data.DataSource.reactor_xmax">
<span class="sig-name descname"><span class="pre">reactor_xmax</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">380</span></em><a class="headerlink" href="#src.data.DataSource.reactor_xmax" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.data.DataSource.reactor_xmin">
<span class="sig-name descname"><span class="pre">reactor_xmin</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">305</span></em><a class="headerlink" href="#src.data.DataSource.reactor_xmin" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.data.DataSource.reactor_ymax">
<span class="sig-name descname"><span class="pre">reactor_ymax</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">380</span></em><a class="headerlink" href="#src.data.DataSource.reactor_ymax" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.data.DataSource.reactor_ymin">
<span class="sig-name descname"><span class="pre">reactor_ymin</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">305</span></em><a class="headerlink" href="#src.data.DataSource.reactor_ymin" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource.run" title="Permalink to this definition"></a></dt>
<dd><p>Generate episodes, train-test-split, and normalize.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource.x_binary">
<span class="sig-name descname"><span class="pre">x_binary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource.x_binary" title="Permalink to this definition"></a></dt>
<dd><p>Random sequence of {0, 1}.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(episodes, steps, dim_x)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource.x_const">
<span class="sig-name descname"><span class="pre">x_const</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource.x_const" title="Permalink to this definition"></a></dt>
<dd><p>Constant, randomly in (0, 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(episodes, steps, dim_x)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource.x_linear">
<span class="sig-name descname"><span class="pre">x_linear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource.x_linear" title="Permalink to this definition"></a></dt>
<dd><p>Line from x(t=0)=0 to x(t=max)=1.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(episodes, steps, dim_x)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.data.DataSource.x_random">
<span class="sig-name descname"><span class="pre">x_random</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.data.DataSource.x_random" title="Permalink to this definition"></a></dt>
<dd><p>Random sequence uniformly in (0, 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(episodes, steps, dim_x)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-src.feedforward">
<span id="src-feedforward-module"></span><h2>src.feedforward module<a class="headerlink" href="#module-src.feedforward" title="Permalink to this heading"></a></h2>
<p>Contains the classes <a class="reference internal" href="#src.feedforward.CPolynomialFeedforward" title="src.feedforward.CPolynomialFeedforward"><code class="xref py py-class docutils literal notranslate"><span class="pre">CPolynomialFeedforward</span></code></a> and <a class="reference internal" href="#src.feedforward.QExtremeLearningMachine" title="src.feedforward.QExtremeLearningMachine"><code class="xref py py-class docutils literal notranslate"><span class="pre">QExtremeLearningMachine</span></code></a>.</p>
<p><a class="reference internal" href="#src.feedforward.CPolynomialFeedforward" title="src.feedforward.CPolynomialFeedforward"><code class="xref py py-class docutils literal notranslate"><span class="pre">CPolynomialFeedforward</span></code></a> is a classical polynomial fitter for comparisons.</p>
<p><a class="reference internal" href="#src.feedforward.QExtremeLearningMachine" title="src.feedforward.QExtremeLearningMachine"><code class="xref py py-class docutils literal notranslate"><span class="pre">QExtremeLearningMachine</span></code></a> is a feedforward (MLP) style model with a quantum circuit as a feature extractor.
It works well, but on the reactor and Narma task having no unitary at all works just as well as a quantum unitary.
This indicates that in our trials, all the power comes from encoding the information and measuring it,
basically transforming the basis into polynomials of sin and cos.</p>
<dl class="py class">
<dt class="sig sig-object py" id="src.feedforward.CPolynomialFeedforward">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.feedforward.</span></span><span class="sig-name descname"><span class="pre">CPolynomialFeedforward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">set_past_y_to_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlookback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylookback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyoffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_true_y_in_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lookback_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">washout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_x_as_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nyfuture</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_future_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sklearn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_l1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.feedforward.CPolynomialFeedforward" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.feedforward.FeedForwardBase" title="src.feedforward.FeedForwardBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeedForwardBase</span></code></a></p>
<p>Classical polynomial fitter for comparisons.</p>
<p>Different during training and inference (validating).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lookback</strong> (<em>int</em>) – how many past y’s are used as input to this stap
(e.g. lookback=3: x(t-1), y(t-1), y(t-2), y(t-3), y(t-4))</p></li>
<li><p><strong>poly_degree</strong> (<em>int</em>) – degree of polynomial features.
e.g. poly_degree=3, lookback=5: 119 features per timestep</p></li>
</ul>
</dd>
</dl>
<p>Additional arguments are passed to <a class="reference internal" href="#src.feedforward.FeedForwardBase" title="src.feedforward.FeedForwardBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeedForwardBase</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.feedforward.CPolynomialFeedforward._set_unitary_and_meas">
<span class="sig-name descname"><span class="pre">_set_unitary_and_meas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.feedforward.CPolynomialFeedforward._set_unitary_and_meas" title="Permalink to this definition"></a></dt>
<dd><p>Difference to QRC: no circuit.
Overwrite method s.t. other QRC methods containing this method can be used</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.feedforward.CPolynomialFeedforward._t_input_to_t_features">
<span class="sig-name descname"><span class="pre">_t_input_to_t_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.feedforward.CPolynomialFeedforward._t_input_to_t_features" title="Permalink to this definition"></a></dt>
<dd><p>Features for this steps, given some input.</p>
<p>Here: polynomial features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_t</strong> (<em>nd.array</em>) – inputs for this step. shape(1, any).</p></li>
<li><p><strong>x0</strong> (<em>nd.array</em><em>)</em><em>. current x. gets added as feature. shape</em><em>(</em><em>1</em><em>, </em><em>dimx</em>) – </p></li>
<li><p><strong>t_pred</strong> (<em>int</em>) – optional. in some model used to save the circuit at a specific step.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.feedforward.CPolynomialFeedforward.model_name">
<span class="sig-name descname"><span class="pre">model_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'baseline_rnn'</span></em><a class="headerlink" href="#src.feedforward.CPolynomialFeedforward.model_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.feedforward.FeedForwardBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.feedforward.</span></span><span class="sig-name descname"><span class="pre">FeedForwardBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xlookback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylookback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyoffset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_past_y_to_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_true_y_in_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lookback_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">washout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_x_as_feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nyfuture</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_future_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_l1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_degree</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.feedforward.FeedForwardBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.basemodel.PredictionModelBase" title="src.basemodel.PredictionModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">PredictionModelBase</span></code></a>, <a class="reference internal" href="#src.basemodel.StepwiseModelBase" title="src.basemodel.StepwiseModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">StepwiseModelBase</span></code></a></p>
<p>Base class for FeedForward like methods.
Provides a training loop for <a class="reference internal" href="#src.feedforward.CPolynomialFeedforward" title="src.feedforward.CPolynomialFeedforward"><code class="xref py py-class docutils literal notranslate"><span class="pre">CPolynomialFeedforward</span></code></a> and <a class="reference internal" href="#src.feedforward.QExtremeLearningMachine" title="src.feedforward.QExtremeLearningMachine"><code class="xref py py-class docutils literal notranslate"><span class="pre">QExtremeLearningMachine</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlookback</strong> (<em>int</em>) – how many past x’s are used as input to this step</p></li>
<li><p><strong>ylookback</strong> (<em>int</em>) – how many past y’s are used as input to this step</p></li>
</ul>
</dd>
</dl>
<p>Additional arguments are passed to <a class="reference internal" href="#src.basemodel.PredictionModelBase" title="src.basemodel.PredictionModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">src.basemodel.PredictionModelBase</span></code></a>
and <a class="reference internal" href="#src.basemodel.StepwiseModelBase" title="src.basemodel.StepwiseModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">src.basemodel.StepwiseModelBase</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.feedforward.FeedForwardBase._get_input_t">
<span class="sig-name descname"><span class="pre">_get_input_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xe_lookback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ye_lookback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.feedforward.FeedForwardBase._get_input_t" title="Permalink to this definition"></a></dt>
<dd><p>Get input for this step from lookup tables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xe_lookback</strong> (<em>nd.array</em>) – lookup table for past actions in this episode. shape(steps_max, dimx).</p></li>
<li><p><strong>ye_lookback</strong> (<em>nd.array</em>) – lookup table for past outputs in this episode. shape(steps_max, dimy).</p></li>
<li><p><strong>t_pred</strong> (<em>int</em>) – timestep to be predicted.</p></li>
<li><p><strong>t_in</strong> (<em>int</em>) – step in loop.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>input for this step (1, xlookback+ylookback)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>input_t (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.feedforward.FeedForwardBase.model_name">
<span class="sig-name descname"><span class="pre">model_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'feedforwardbase'</span></em><a class="headerlink" href="#src.feedforward.FeedForwardBase.model_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.feedforward.QExtremeLearningMachine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.feedforward.</span></span><span class="sig-name descname"><span class="pre">QExtremeLearningMachine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">set_past_y_to_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_true_y_in_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlookback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylookback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyoffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lookback_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">washout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_x_as_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nyfuture</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_future_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sklearn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_l1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nqubits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ising'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlayers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'angle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nenccopies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encangle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_jmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_wmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_random</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_jpositive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_wpositive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'aer_simulator'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'statevector'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.feedforward.QExtremeLearningMachine" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.feedforward.FeedForwardBase" title="src.feedforward.FeedForwardBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeedForwardBase</span></code></a>, <a class="reference internal" href="#src.basemodel.QuantumBase" title="src.basemodel.QuantumBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumBase</span></code></a></p>
<p>Feedforward model with quantum circuit as feature extractor.</p>
<p>Takes x(t-1) (action) and previous ouputs y(t-n-1), …, y(t-1) as input at each step.
Performs one step, then measures all qubits.
The results of the measurements are the features f(t).
After all training steps, f(t) are fitted to y(t) via an Ordinary Linear System fitter.</p>
<div class="math notranslate nohighlight">
\[y_{t+1} = f(x_{t}, ..., x_{t-looback}, y_{t}, ..., y_{t-lookback})\]</div>
<p>During training the model takes all x(t-1) as given and uses the correct {y(t-i)} from the data.
During inference (validating) uses the previous predicted outputs {~y(t-i)} and x(t-1) can depend on the previous prediction.</p>
<p>All arguments are passed to <a class="reference internal" href="#src.feedforward.FeedForwardBase" title="src.feedforward.FeedForwardBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeedForwardBase</span></code></a>
and <a class="reference internal" href="#src.basemodel.QuantumBase" title="src.basemodel.QuantumBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">src.basemodel.QuantumBase</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.feedforward.QExtremeLearningMachine._get_step_features">
<span class="sig-name descname"><span class="pre">_get_step_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveqc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.feedforward.QExtremeLearningMachine._get_step_features" title="Permalink to this definition"></a></dt>
<dd><p>Features for this step, provided the input angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>angles</strong> (<em>np.ndarray</em>) – angles for the input data (1, dimxqc)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>features for this step (1, dimf)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.feedforward.QExtremeLearningMachine._set_unitary_and_meas">
<span class="sig-name descname"><span class="pre">_set_unitary_and_meas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#src.feedforward.QExtremeLearningMachine._set_unitary_and_meas" title="Permalink to this definition"></a></dt>
<dd><p>Define unitary quantum circuit for every timestep.
Sets self.unistep.
Does not set input encoding or measurements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.feedforward.QExtremeLearningMachine._t_input_to_t_features">
<span class="sig-name descname"><span class="pre">_t_input_to_t_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.feedforward.QExtremeLearningMachine._t_input_to_t_features" title="Permalink to this definition"></a></dt>
<dd><p>Features for this steps, given some input.</p>
<p>Encodes input into angles, runs circuit, turns measurements into features (expectation values).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_t</strong> (<em>nd.array</em>) – inputs for this step. shape(1, any).</p></li>
<li><p><strong>x0</strong> (<em>nd.array</em><em>)</em><em>. current x. gets added as feature. shape</em><em>(</em><em>1</em><em>, </em><em>dimx</em>) – </p></li>
<li><p><strong>t_pred</strong> (<em>int</em>) – optional. Used to save the circuit at the specified step.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.feedforward.QExtremeLearningMachine.model_name">
<span class="sig-name descname"><span class="pre">model_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'qelm'</span></em><a class="headerlink" href="#src.feedforward.QExtremeLearningMachine.model_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-src.helpers">
<span id="src-helpers-module"></span><h2>src.helpers module<a class="headerlink" href="#module-src.helpers" title="Permalink to this heading"></a></h2>
<p>Collection of math functions to calculate error metrics and normalize data.</p>
<dl class="py function">
<dt class="sig sig-object py" id="src.helpers.correlation">
<span class="sig-prename descclassname"><span class="pre">src.helpers.</span></span><span class="sig-name descname"><span class="pre">correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.helpers.correlation" title="Permalink to this definition"></a></dt>
<dd><p>Pearson correlation coefficient.</p>
<p>Timesteps are rows, dims are colums.
Implementation only works for dim=1?</p>
<div class="math notranslate nohighlight">
\[CC = \frac{cov^2 \left( s^{true}, s^{pred} \right)}{\sigma_{s^{true}}^2 \sigma_{s^{pred}}^2}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>np.array</em>) – predictions of shape(steps, dimy)</p></li>
<li><p><strong>b</strong> (<em>np.array</em>) – predictions of shape(steps, dimy)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>float in (-1, 1)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.helpers.mape">
<span class="sig-prename descclassname"><span class="pre">src.helpers.</span></span><span class="sig-name descname"><span class="pre">mape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.helpers.mape" title="Permalink to this definition"></a></dt>
<dd><p>Mean Absolute Percentage Error (MAPE).
Scale independent. Works best with data without zeros and extreme values</p>
<div class="math notranslate nohighlight">
\[\frac{100}{N_{t}} \sum_{t}^{N_t} \frac{\vert s_t^{pred} - s_t^{true} \vert}{s_t^{true}}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred</strong> (<em>np.array</em>) – predictions of shape(steps, dimy)</p></li>
<li><p><strong>true</strong> (<em>np.array</em>) – predictions of shape(steps, dimy)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.helpers.moving_average">
<span class="sig-prename descclassname"><span class="pre">src.helpers.</span></span><span class="sig-name descname"><span class="pre">moving_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.helpers.moving_average" title="Permalink to this definition"></a></dt>
<dd><p>Moving average filter using convolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – data of shape(steps, dimy)</p></li>
<li><p><strong>w</strong> (<em>int</em>) – window size</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filtered data of shape(steps-w+1, dimy)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.helpers.mse">
<span class="sig-prename descclassname"><span class="pre">src.helpers.</span></span><span class="sig-name descname"><span class="pre">mse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.helpers.mse" title="Permalink to this definition"></a></dt>
<dd><p>Mean squared error.
Scale dependent: don’t use to compare different target sequences.</p>
<div class="math notranslate nohighlight">
\[\frac{1}{N_{t}} \sum_{t}^{N_t} \vert s_t^{pred} - s_t^{true} \vert^2\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred</strong> (<em>np.array</em>) – predictions of shape(steps, dimy)</p></li>
<li><p><strong>true</strong> (<em>np.array</em>) – predictions of shape(steps, dimy)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.helpers.normalize">
<span class="sig-prename descclassname"><span class="pre">src.helpers.</span></span><span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.helpers.normalize" title="Permalink to this definition"></a></dt>
<dd><p>Normalization is a rescaling of the data from the original range so that
all values are within the range of 0 and 1.</p>
<p>Works well if you have no outliers.
new = (old - min) / (max - min)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>list</em><em>[</em><em>np.array</em><em>]</em>) – (episodes, steps, dims)</p></li>
<li><p><strong>dmin</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>np.array</em><em>[</em><em>int</em><em>]</em>) – current data range</p></li>
<li><p><strong>dmax</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>np.array</em><em>[</em><em>int</em><em>]</em>) – current data range</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(episodes, steps, dims)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>normalized_data (list[np.array])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.helpers.nrmse">
<span class="sig-prename descclassname"><span class="pre">src.helpers.</span></span><span class="sig-name descname"><span class="pre">nrmse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.helpers.nrmse" title="Permalink to this definition"></a></dt>
<dd><p>Normalized Root Mean Squared Error (NRMSE).</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}\frac{ \left( 1/N \sum |y-y'|^2 \right)^{1/2} } { 1/N \sum y} \\\end{split}\\\frac{ \sqrt{  \frac{1}{N_t} \sum_{t}^{N_t} \vert s_t^{pred} - s_t^{true} \vert^2 } } { \frac{1}{N_t} \sum_{t}^{N_t} s_t^{true}}\end{aligned}\end{align} \]</div>
<p>Scale independent. Use for comparing different datasets or forecasting models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred</strong> (<em>np.array</em>) – predictions of shape(steps, dimy)</p></li>
<li><p><strong>true</strong> (<em>np.array</em>) – predictions of shape(steps, dimy)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.helpers.standardize">
<span class="sig-prename descclassname"><span class="pre">src.helpers.</span></span><span class="sig-name descname"><span class="pre">standardize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.helpers.standardize" title="Permalink to this definition"></a></dt>
<dd><p>Standardizing a dataset involves rescaling the distribution of values so
that the mean of observed values is 0 and the standard deviation is 1.</p>
<p>Works well if data is approximately gaussian (normal).
Skewed data distributions will remain skewed.</p>
<div class="math notranslate nohighlight">
\[\begin{split}x^{std}_t = (x_t - mean) / std \\
mean = \sum_t x_t / N_t \\
std = \sqrt{ 1/N_t \sum_t (x_t - mean)^2 }\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – list[np.array] (episodes, steps, dims)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list[np.array] (episodes, steps, dims)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>standardized_data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.helpers.unnormalize">
<span class="sig-prename descclassname"><span class="pre">src.helpers.</span></span><span class="sig-name descname"><span class="pre">unnormalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.helpers.unnormalize" title="Permalink to this definition"></a></dt>
<dd><p>Reverse scaling. (0, 1) -&gt; (dmin, dmax).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – list[np.array] (episodes, steps, dims)</p></li>
<li><p><strong>dmin</strong> – previous data range we want to return to</p></li>
<li><p><strong>dmax</strong> – previous data range we want to return to</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list[np.array] (episodes, steps, dims)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>unnormalized_data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.helpers.weighted_gate_count">
<span class="sig-prename descclassname"><span class="pre">src.helpers.</span></span><span class="sig-name descname"><span class="pre">weighted_gate_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.helpers.weighted_gate_count" title="Permalink to this definition"></a></dt>
<dd><p>Number of single qubit gates + 10 * number of two qubit gates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qc</strong> (<em>QuantumCircuit</em>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.noisemodel">
<span id="src-noisemodel-module"></span><h2>src.noisemodel module<a class="headerlink" href="#module-src.noisemodel" title="Permalink to this heading"></a></h2>
<p>Provides the <code class="xref py py-class docutils literal notranslate"><span class="pre">NoiseModel</span></code> class for representing a simple noise model based on T1, T2 thermal relaxation times.</p>
<dl class="py function">
<dt class="sig sig-object py" id="src.noisemodel.thermal_model">
<span class="sig-prename descclassname"><span class="pre">src.noisemodel.</span></span><span class="sig-name descname"><span class="pre">thermal_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nqubits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1_mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2_mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.noisemodel.thermal_model" title="Permalink to this definition"></a></dt>
<dd><p>Thermal Relaxation example from Qiskit.</p>
<p><a class="reference external" href="https://qiskit.org/documentation/tutorials/simulators/3_building_noise_models.html#Example-2:-T1/T2-thermal-relaxation">https://qiskit.org/documentation/tutorials/simulators/3_building_noise_models.html#Example-2:-T1/T2-thermal-relaxation</a></p>
<p>T1 and T2 values for qubits sampled from normal distribution with mean
50 and 70 microsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t1_mean</strong> (<em>float</em>) – 50 microseconds</p></li>
<li><p><strong>t2_mean</strong> (<em>float</em>) – 70 microseconds</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>qiskit_aer.noise.NoiseModel</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.rewinding">
<span id="src-rewinding-module"></span><h2>src.rewinding module<a class="headerlink" href="#module-src.rewinding" title="Permalink to this heading"></a></h2>
<p>Contains <a class="reference internal" href="#src.rewinding.QRewindingRC" title="src.rewinding.QRewindingRC"><code class="xref py py-class docutils literal notranslate"><span class="pre">QRewindingRC</span></code></a> and <a class="reference internal" href="#src.rewinding.QRewindingStatevectorRC" title="src.rewinding.QRewindingStatevectorRC"><code class="xref py py-class docutils literal notranslate"><span class="pre">QRewindingStatevectorRC</span></code></a> classes.</p>
<p><a class="reference internal" href="#src.rewinding.QRewindingStatevectorRC" title="src.rewinding.QRewindingStatevectorRC"><code class="xref py py-class docutils literal notranslate"><span class="pre">QRewindingStatevectorRC</span></code></a> is the quantum reservoir model performing the best.
In theory <a class="reference internal" href="#src.rewinding.QRewindingRC" title="src.rewinding.QRewindingRC"><code class="xref py py-class docutils literal notranslate"><span class="pre">QRewindingRC</span></code></a> should perform the same, but a lot slower.
In practice <a class="reference internal" href="#src.rewinding.QRewindingStatevectorRC" title="src.rewinding.QRewindingStatevectorRC"><code class="xref py py-class docutils literal notranslate"><span class="pre">QRewindingStatevectorRC</span></code></a> is has been much more tested and is highly recommended in all situations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="src.rewinding.QRewindingRC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.rewinding.</span></span><span class="sig-name descname"><span class="pre">QRewindingRC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_partial_meas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_instead_meas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lookback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lookback_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restarting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_y_to_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">washout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preloading</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'projection'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmeas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reseti</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resetm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nenccopies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyoffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_past_y_to_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_true_y_in_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_x_as_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nyfuture</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_future_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sklearn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_l1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nqubits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ising'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlayers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'angle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encangle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_jmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_wmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_random</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_jpositive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_wpositive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'aer_simulator'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'statevector'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.rewinding.QRewindingRC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.basemodel.StepwiseModelBase" title="src.basemodel.StepwiseModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">StepwiseModelBase</span></code></a>, <a class="reference internal" href="#src.continuous.QContinuousRC" title="src.continuous.QContinuousRC"><code class="xref py py-class docutils literal notranslate"><span class="pre">QContinuousRC</span></code></a></p>
<p>Takes x(t) (action) and previous ouput y(t-1) as input.
Repeats past n steps and the current step, then measures all qubits.</p>
<p>During training the model takes all x(t) as given and uses the correct y(t-1) from the data.
During inference (validating) uses the previous predicted output ~ y(t-1) and x(t) can depend on the previous prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nmeas</strong> (<em>int</em>) – Number of qubits to be measured at every rewinded (non-final) step.
A final step all qubits are measured.</p></li>
<li><p><strong>reset_instead_meas</strong> (<em>bool</em>) – Reset qubits instead of measuring at every rewinded (non-final) step.</p></li>
<li><p><strong>resetm</strong> (<em>bool</em>) – Reset qubits after measurement at every rewinded (non-final) step.</p></li>
<li><p><strong>use_partial_meas</strong> (<em>bool</em>) – If partial measurements at every rewinded (non-final) step are to be used for features.
Set to ‘False’ if ‘reset_instead_meas’ is ‘True’.</p></li>
<li><p><strong>lookback</strong> (<em>int</em>) – Number of steps to be rewinded at every step.</p></li>
<li><p><strong>restarting</strong> (<em>bool</em>) – If to restart at every step (rewind to the beginning).</p></li>
<li><p><strong>lookback_max</strong> (<em>bool</em>) – If restarting is True, this is ignored (and set to True).
If True, the number of steps to be rewinded is the maximum possible (all previous steps),
but never goes further back than step 0.
If False, steps before t=0 are possibly repeated as well, with input values depending on <code class="code docutils literal notranslate"><span class="pre">set_past_y_to_0</span></code>.</p></li>
<li><p><strong>add_y_to_input</strong> (<em>bool</em>) – If to use previous y(t) in addition to x(t) as input.</p></li>
</ul>
</dd>
</dl>
<p>Additional arguments are passed to <a class="reference internal" href="#src.basemodel.StepwiseModelBase" title="src.basemodel.StepwiseModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">src.basemodel.StepwiseModelBase</span></code></a>
and <code class="xref py py-class docutils literal notranslate"><span class="pre">src.continuous.QOnlineReservoir</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.rewinding.QRewindingRC._get_input_t">
<span class="sig-name descname"><span class="pre">_get_input_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xe_lookback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ye_lookback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.rewinding.QRewindingRC._get_input_t" title="Permalink to this definition"></a></dt>
<dd><p>Every step is a mini-episode:
At every step, repeat past n steps + current step.
At the current step, feed in current action x(t) and previous ouput y(t-1).
At the past n’th step, feed in action x(t-n) and previous output y(t-n-1).
In training previous outpus y are the true values from the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(lookback, dimxqc)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>angles (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.rewinding.QRewindingRC._get_step_features">
<span class="sig-name descname"><span class="pre">_get_step_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveqc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.rewinding.QRewindingRC._get_step_features" title="Permalink to this definition"></a></dt>
<dd><p>Features for this step, provided the input angles.
At every step, the circuit consists of lookback+1 steps</p>
<p>angles (np.ndarray): (nsteps, dimxqc)
nsteps (int): how many previous steps should be repeated (including the current step).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>features for this step (1, dimf)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.rewinding.QRewindingRC._set_unitary_and_meas">
<span class="sig-name descname"><span class="pre">_set_unitary_and_meas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.rewinding.QRewindingRC._set_unitary_and_meas" title="Permalink to this definition"></a></dt>
<dd><p>Define unitary quantum circuit at every timestep.
Sets self.unistep.
Excludes input encoding and measurements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.rewinding.QRewindingRC._t_input_to_t_features">
<span class="sig-name descname"><span class="pre">_t_input_to_t_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.rewinding.QRewindingRC._t_input_to_t_features" title="Permalink to this definition"></a></dt>
<dd><p>Features of a step, given the input.</p>
<p>Calls angle_encoding and get_step_features.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.rewinding.QRewindingRC.model_name">
<span class="sig-name descname"><span class="pre">model_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'rewinding_rc'</span></em><a class="headerlink" href="#src.rewinding.QRewindingRC.model_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.rewinding.QRewindingStatevectorRC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.rewinding.</span></span><span class="sig-name descname"><span class="pre">QRewindingStatevectorRC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'multinomial'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_partial_meas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_instead_meas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lookback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_y_to_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restarting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_past_y_to_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_true_y_in_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">washout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preloading</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'projection'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmeas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reseti</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resetm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lookback_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_x_as_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nyfuture</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_future_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sklearn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_l1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nqubits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ising'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlayers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'angle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nenccopies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encangle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_jmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_wmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_random</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_jpositive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ising_wpositive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'aer_simulator'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'statevector'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.rewinding.QRewindingStatevectorRC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.rewinding.QRewindingRC" title="src.rewinding.QRewindingRC"><code class="xref py py-class docutils literal notranslate"><span class="pre">QRewindingRC</span></code></a></p>
<p>Statevector.</p>
<p>Intended to be faster when using mid circuit measurements or resets.</p>
<p>If set to restarting, will evolve one statevector through all steps.
If set to rewinding, will create new statevector and evolve through past steps.</p>
<p>When doing noisy simulations we need to move from Statevector to DensityMatrix.
Considerably slower.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sim_sampling</strong> (<em>str</em>) – <div class="line-block">
<div class="line">method to sample counts from statevector, which are then used to estimate expectation values.</div>
<div class="line">qiskit: use qiskit’s <code class="code docutils literal notranslate"><span class="pre">qiskit.quantum_info.Statevector.sample_counts()</span></code>. crazy slow.</div>
<div class="line">multinomial: <code class="code docutils literal notranslate"><span class="pre">np.multinomial</span></code>. 10x faster and same result as qiskit.
Speedup is less when compared to <code class="code docutils literal notranslate"><span class="pre">qiskit.quantum_info.DensityMatrix.sample_counts()</span></code>.</div>
<div class="line">naive: uses exact probabilies to generate counts. expectation values are still estimated from counts.</div>
<div class="line">exact: calculates expectation values directly from statevector.</div>
</div>
</p>
</dd>
</dl>
<p>Additional arguments are passed to <a class="reference internal" href="#src.rewinding.QRewindingRC" title="src.rewinding.QRewindingRC"><code class="xref py py-class docutils literal notranslate"><span class="pre">QRewindingRC</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.rewinding.QRewindingStatevectorRC._counts_from_sv">
<span class="sig-name descname"><span class="pre">_counts_from_sv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.rewinding.QRewindingStatevectorRC._counts_from_sv" title="Permalink to this definition"></a></dt>
<dd><p>Naive alternative to Qiskit’s statevector.get_counts() using probabilities.</p>
<p>Qiskit becomes very slow for growing number of qubits.
I think Qiskit uses a metropolis hasting (Monte Carlo) algorithm under the hood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sv</strong> (<em>qiskit.quantum_info.statevector</em>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>counts (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.rewinding.QRewindingStatevectorRC._get_input_t">
<span class="sig-name descname"><span class="pre">_get_input_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xe_lookback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ye_lookback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.rewinding.QRewindingStatevectorRC._get_input_t" title="Permalink to this definition"></a></dt>
<dd><p>Every step is a mini-episode:
At every step, repeat past n steps + current step.
At the current step, feed in current action x(t) and previous ouput y(t-1).
At the past n’th step, feed in action x(t-n) and previous output y(t-n-1).
In training previous outpus y are the true values from the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(lookback, dimxqc)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>angles (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.rewinding.QRewindingStatevectorRC._get_step_features">
<span class="sig-name descname"><span class="pre">_get_step_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveqc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.rewinding.QRewindingStatevectorRC._get_step_features" title="Permalink to this definition"></a></dt>
<dd><p>Features for this step.
At every step, the circuit consists of lookback+1 steps.
statev: qiskit.quantum_info.Statevector() or qiskit.quantum_info.DensityMatrix()</p>
<p>angles (np.ndarray): (nsteps, dimxqc)
nsteps (int): how many previous steps should be repeated (including the current step).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>features for this step (1, dimf)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.rewinding.QRewindingStatevectorRC._t_input_to_t_features">
<span class="sig-name descname"><span class="pre">_t_input_to_t_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.rewinding.QRewindingStatevectorRC._t_input_to_t_features" title="Permalink to this definition"></a></dt>
<dd><p>Features of a step, given the input.</p>
<p>Calls angle_encoding and get_step_features.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.rewinding.QRewindingStatevectorRC.model_name">
<span class="sig-name descname"><span class="pre">model_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'rewinding_statevector_rc'</span></em><a class="headerlink" href="#src.rewinding.QRewindingStatevectorRC.model_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-src">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-src" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="src" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Andreas Burger.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>